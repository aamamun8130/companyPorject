<div class="overlay-container">
    <div class="overlay">
        <div class="margin-auto chart-box">
            <section class="clearfix">
                <label class="ch-title mian-color w3-large ex-font" style="float: left; margin-top: 8px;">Users</label>
                <button onclick="document.getElementById('id01').style.display='block'" class="w3-btn w3-xlarge w3-circle w3-white circle-btn"
                    style="float: right;">+</button>
                <!-- <button class="w3-btn w3-xlarge w3-circle w3-white circle-btn"><i class="fa fa-edit"></i></button>
                    <button class="w3-btn w3-xlarge w3-circle w3-white circle-btn"><i class="fa fa-print"></i></button> -->
            </section>
            <div class="w3-card-4 table-container">
                <div class="ch-table-content">
                    <div class="w3-responsive">
                        <table class="w3-table-all chart-tables">
                            <thead>
                                <tr class="main-bg-color">
                                    <th>No</th>
                                    <th>Email</th>
                                    <th>Name</th>
                                    <th style="width: 220px;">Permission</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr ng-repeat="comAcc in comAccounts | orderBy : 'flag' track by $index">
                                    <td>{{$index + 1}}</td>
                                    <td>{{comAcc.nature}}</td>
                                    <td>{{comAcc.accCode}}</td>
                                    <td>{{comAcc.accText}}</td>
                                    <td>
                                        <button id="{{comAcc.$id}}e" onclick="editItem(event)" class="w3-btn w3-blue">Edit</button>
                                        <button id="{{comAcc.$id}}ec" onclick="editConfirm(event)" class="w3-btn w3-blue"
                                            style="display: none;">Update</button>
                                    </td>
                                    <td>
                                        <button id="{{comAcc.$id}}" onclick="removeItem(event)" class="w3-btn w3-red">Delete</button>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                        <div ng-show="!load" class="w3-pale-blue" style="padding: 12px; text-align: center;"><img src="img/loader.gif"
                                alt="Loading..." style="height: 25px; width: 25px;"></div>
                        <div id="nodata" ng-show="nodata" class="w3-pale-blue" style="padding: 12px; text-align: center;">No
                            Data Found!</div>
                    </div>
                </div>
            </div>
        </div>
        <div id="confirmDel" class="w3-modal">
            <div class="w3-modal-content div-box w3-animate-zoom w3-card-4" style="width: 450px;">
                <header class="w3-container main-bg-color div-title">
                    <span onclick="$js('confirmDel').style.display='none'" class="w3-button w3-display-topright">&times;</span>
                    <h2>Confirm Delete?</h2>
                </header>
                <div class="w3-container">
                    <p>Deleting this account will not remove name from journal account name.</p>
                    <p>And no more suggestion is available for this account code until you create new one.</p>
                </div>
                <footer class="w3-container w3-white">
                    <p class="flex" style="justify-content: center;">
                        <button id="delAcBtn" class="w3-btn w3-red" style="margin-left: 20px; margin-right: 20px;">Confirm
                            Delete</button>
                        <button onclick="$js('confirmDel').style.display='none'" class="w3-btn main-bg-color" style="margin-left: 20px; margin-right: 20px;">Cancel</button>
                    </p>
                </footer>
            </div>
        </div>
        <div id="id01" class="w3-modal">
            <div class="w3-modal-content w3-animate-zoom" style="background-color: transparent;">
                <div class="div-box w3-light-gray w3-card-4 margin-auto" style="display: block;">
                    <header class="w3-container main-bg-color div-title">
                        <span onclick="exitModel();clearFields();" class="w3-button w3-display-topright">&times;</span>
                        <h2>Register User</h2>
                    </header>
                    <div class="w3-container">
                        <input id="emailField" class="w3-input w3-border" type="text" style="width: 100%; margin-top: 28px; padding: 10px;"
                            placeholder="Email">
                        <input id="passwordField" class="w3-input w3-border" type="password" style="width: 100%; margin-top: 22px; padding: 10px;"
                            placeholder="Password">
                        <input id="rePasswordField" class="w3-input w3-border" type="password" style="width: 100%; margin-top: 22px; padding: 10px;"
                            placeholder="Re-enter Password">
                        <input id="nameField" class="w3-input w3-border" type="text" style="width: 100%; margin-top: 22px; padding: 10px;"
                            placeholder="Name">
                        <p style="padding: 6px;" class="clearfix">
                            <button id="regBtn" style="float: right;" class="w3-btn main-bg-color">Register</button>
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script>
    let email = $js('emailField');
    let password = $js('passwordField');
    let rePassword = $js('rePasswordField');
    let name = $js('nameField');
    $js('regBtn').addEventListener('click', function () {
        if (email.value == "") {
            notify('Empty Email!', 2);
            email.focus();
            return;
        }
        else if (password.value == "") {
            notify('Empty Password!', 2);
            password.focus();
            return;
        }
        else if (rePassword.value == "") {
            notify('Re-enter Password Empty!', 2);
            rePassword.focus();
            return;
        }
        else if (rePassword.value != password.value) {
            notify('Password Not Matched!', 2);
            rePassword.focus();
            return;
        }
        else if (name.value == "") {
            notify('Password Not Matched!', 2);
            name.focus();
            return;
        }
        firebase.auth().createUserWithEmailAndPassword(email.value, password.value)
            .then(function (success) {
                let user = { 
                    email : email.value,
                    name : name.value
                }
                db.child('accounts').push(account, function (error) {
                    if (error) {
                        notify('Something Went Wrong in Database!', 2);
                    } else {
                        notify('User Added Sucessfully', 1);
                        $js('nodata').style.display = "none";
                        clearAccFields();
                    }
                });
                exitModel();
            })
            .catch(function (error) {
                // Handle Errors here.
                var errorCode = error.code;
                var errorMessage = error.message;
                alert(errorMessage);
            });
        $print('ok');
    });
    function clearFields() {
        clearer(email, password, rePassword, name);
    }
</script>